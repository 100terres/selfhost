#!/usr/bin/env bash

read -s -p "Enter KeePass Password: " PASSWORD

printf "\nThank you!"

# Core must be first!
printf "\nstart: Core\n"
cd services/core
docker compose up --detach --wait --remove-orphans
cd ../..
printf "\ndone: Core\n"

printf "\nstart: Personal Mastodon Instance\n"
cd services/personal-mastodon-instance
docker compose up --detach --wait --remove-orphans
cd ../..
printf "\ndone: Personal Mastodon Instance\n"

printf "\nstart: Professional Mastodon Instance\n"
cd services/professional-mastodon-instance
docker compose up --detach --wait --remove-orphans
cd ../..
printf "\ndone: Professional Mastodon Instance\n"

printf "\nstart: Forgejo Runner\n"
cd services/forgejo-runner
docker compose up --detach --wait --remove-orphans
cd ../..
printf "\ndone: Forgejo Runner\n"

printf "\nstart: Self Hosting Demo\n"
cd services/self-hosting-demo
docker compose up --detach --wait --remove-orphans
cd ../..
printf "\ndone: Self Hosting Demo\n"

cd services/forgejo
printf "\nstart: Forgejo\n"
FNOX_KEEPASS_PASSWORD=$PASSWORD fnox exec --if-missing error -- docker compose up --detach --wait --remove-orphans
cd ../..
printf "\ndone: Forgejo\n"
